ISO-10303-21;
HEADER;
FILE_DESCRIPTION(('ViewDefinition [CoordinationView]'),'2;1');
FILE_NAME('hvac_with_edge_devices.ifc','2025-01-01T00:00:00',('ChatGPT'),('ChatGPT'),'IFC HVAC Example','','');
FILE_SCHEMA(('IFC4'));
ENDSEC;

DATA;

/* ======= GLOBAL CONTEXT ======= */
#1 = IFCCARTESIANPOINT((0.,0.,0.));
#2 = IFCAXIS2PLACEMENT3D(#1,$,$);
#3 = IFCGEOMETRICREPRESENTATIONCONTEXT($,'Model',3,1.E-5,#2,$);

/* ======= PROJECT / SITE / BUILDING / STOREY ======= */
#10 = IFCPROJECT('PRJ-001','DigitalTwin HVAC',$,$,$,$,$,(#3));
#20 = IFCSITE('SITE-001','Campus A',$,$,$,$,$,.ELEMENT.,$,$,$,$,.USERDEFINED.);
#30 = IFCBUILDING('BLDG-001','Main Building',$,$,$,$,$,.ELEMENT.,$,$);
#40 = IFCBUILDINGSTOREY('STY-001','Level 1',$,$,$,$,0.0,.ELEMENT.,$);

/* Hierarchy */
#50 = IFCRELAGGREGATES('REL-P-S',$,'Project-Site',$,#10,(#20));
#51 = IFCRELAGGREGATES('REL-S-B',$,'Site-Building',$,#20,(#30));
#52 = IFCRELAGGREGATES('REL-B-Sty',$,'Building-Storey',$,#30,(#40));

/* ======= SPACES (2 offices + 1 mechanical room) ======= */
/* Room 101: rectangle (0,0)-(6,0)-(6,4)-(0,4) */
#60  = IFCCARTESIANPOINT((0.,0.,0.));
#61  = IFCCARTESIANPOINT((6.,0.,0.));
#62  = IFCCARTESIANPOINT((6.,4.,0.));
#63  = IFCCARTESIANPOINT((0.,4.,0.));
#64  = IFCPOLYLINE((#60,#61,#62,#63,#60));
#65  = IFCSHAPEREPRESENTATION(#3,'Body','Curve2D',(#64));
#70  = IFCSPACE('RM-101','Room 101','Open Office',$,$,#65,$,.INTERNAL.,.ELEMENT.,$);

/* Room 102: rectangle (7,0)-(13,0)-(13,4)-(7,4) */
#71  = IFCCARTESIANPOINT((7.,0.,0.));
#72  = IFCCARTESIANPOINT((13.,0.,0.));
#73  = IFCCARTESIANPOINT((13.,4.,0.));
#74  = IFCCARTESIANPOINT((7.,4.,0.));
#75  = IFCPOLYLINE((#71,#72,#73,#74,#71));
#76  = IFCSHAPEREPRESENTATION(#3,'Body','Curve2D',(#75));
#80  = IFCSPACE('RM-102','Room 102','IT Room',$,$,#76,$,.INTERNAL.,.ELEMENT.,$);

/* Mechanical room: rectangle (-4,-2)-(-4,6)-( -1,6 )-( -1,-2 ) */
#81  = IFCCARTESIANPOINT((-4.,-2.,0.));
#82  = IFCCARTESIANPOINT((-1.,-2.,0.));
#83  = IFCCARTESIANPOINT((-1.,6.,0.));
#84  = IFCCARTESIANPOINT((-4.,6.,0.));
#85  = IFCPOLYLINE((#81,#82,#83,#84,#81));
#86  = IFCSHAPEREPRESENTATION(#3,'Body','Curve2D',(#85));
#90  = IFCSPACE('MECH-1','Mechanical Room','Plant Room',$,$,#86,$,.INTERNAL.,.ELEMENT.,$);

/* Place spaces on Level 1 */
#95 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-Sty-Sp',$,'Storey-Spaces',$,(#70,#80,#90),#40);

/* ======= EQUIPMENT (MECH ROOM) ======= */
/* Simple placements (x,y,z meters); z≈0.1 above floor */
#100 = IFCCARTESIANPOINT((-3.5,0.5,0.1));
#101 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#100,$,$));
#110 = IFCCHILLER('CH-001','Chiller-01','Air-cooled chiller',$,$,#101,$,.AIRCOOLED.);

#111 = IFCCARTESIANPOINT((-3.0,2.0,0.1));
#112 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#111,$,$));
#120 = IFCPUMP('P-001','CHW-Pump-01','Primary CHW Pump',$,$,#112,$,.CIRCULATOR.);

#121 = IFCCARTESIANPOINT((-2.0,1.0,0.1));
#122 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#121,$,$));
#130 = IFCAIRHANDLINGUNIT('AHU-001','AHU-01','Supply AHU',$,$,#122,$,.ROOFTOPUNIT.);

/* Put plant equipment into MECH-1 space */
#135 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-Mech-Eqp',$,'MechRoom-Equipment',$,(#110,#120,#130),#90);

/* ======= DUCTS & DIFFUSERS (Level 1) ======= */
/* Two simple supply duct segments and two diffusers */
#140 = IFCCARTESIANPOINT((1.5,2.0,2.7));     /* duct near Room 101 */
#141 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#140,$,$));
#142 = IFCDUCTSEGMENT('DUCT-101','Duct to RM-101','SA Branch',$,$,#141,$,.SUPPLYAIR.);

#143 = IFCCARTESIANPOINT((10.0,2.0,2.7));    /* duct near Room 102 */
#144 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#143,$,$));
#145 = IFCDUCTSEGMENT('DUCT-102','Duct to RM-102','SA Branch',$,$,#144,$,.SUPPLYAIR.);

#150 = IFCCARTESIANPOINT((3.0,2.0,2.6));     /* diffuser in RM-101 */
#151 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#150,$,$));
#152 = IFCAIRTERMINAL('DF-101','Diffuser-101','Square Diffuser',$,$,#151,$,.DIFFUSER.);

#153 = IFCCARTESIANPOINT((11.0,2.0,2.6));    /* diffuser in RM-102 */
#154 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#153,$,$));
#155 = IFCAIRTERMINAL('DF-102','Diffuser-102','Square Diffuser',$,$,#154,$,.DIFFUSER.);

/* Place ducts & terminals in spaces */
#156 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-RM101-Air',$,'Room101-AirElements',$,(#142,#152),#70);
#157 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-RM102-Air',$,'Room102-AirElements',$,(#145,#155),#80);

/* ======= SENSORS ======= */
/* Plant sensors in MECH-1 */
#160 = IFCCARTESIANPOINT((-3.2,2.2,1.3));  /* pump flow sensor */
#161 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#160,$,$));
#162 = IFCSENSOR('FS-001','FlowSensor-P1','CHW Flow',$,$,#161,$,'FLOWSENSOR');

#163 = IFCCARTESIANPOINT((-2.2,1.2,1.6));  /* AHU discharge pressure */
#164 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#163,$,$));
#165 = IFCSENSOR('PS-001','PressSensor-AHU','SA Static Pressure',$,$,#164,$,'PRESSURESENSOR');

#166 = IFCCARTESIANPOINT((-2.1,1.1,1.6));  /* AHU supply air temp */
#167 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#166,$,$));
#168 = IFCSENSOR('TS-SAT-01','TempSensor-SAT','Supply Air Temp',$,$,#167,$,'TEMPERATURESENSOR');

#169 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-Mech-Sense',$,'MechRoom-Sensors',$,(#162,#165,#168),#90);

/* Room sensors */
#170 = IFCCARTESIANPOINT((2.5,2.0,1.5));  /* RM-101 temperature */
#171 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#170,$,$));
#172 = IFCSENSOR('TS-101','Temp-RM101','Zone Temp',$,$,#171,$,'TEMPERATURESENSOR');

#173 = IFCCARTESIANPOINT((1.2,2.0,1.5));  /* RM-101 humidity */
#174 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#173,$,$));
#175 = IFCSENSOR('HS-101','Humidity-RM101','Zone RH',$,$,#174,$,'HUMIDITYSENSOR');

#176 = IFCCARTESIANPOINT((10.5,2.0,1.5)); /* RM-102 CO2 */
#177 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#176,$,$));
#178 = IFCSENSOR('CS-102','CO2-RM102','Zone CO2',$,$,#177,$,'CO2SENSOR');

#179 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-RM101-Sense',$,'Room101-Sensors',$,(#172,#175),#70);
#180 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-RM102-Sense',$,'Room102-Sensors',$,(#178),#80);

/* ======= EDGE DEVICES ======= */
#181 = IFCCARTESIANPOINT((-3.6,0.8,1.7));  /* plant edge device in MECH-1 */
#182 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#181,$,$));
#183 = IFCDISTRIBUTIONCONTROLELEMENT('EDGE-MECH','EdgeGateway-Plant','IoT Edge for Plant',$,$,#182,$,.USERDEFINED.);

#184 = IFCCARTESIANPOINT((4.8,3.5,1.7));   /* floor edge device near RM-101 */
#185 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#184,$,$));
#186 = IFCDISTRIBUTIONCONTROLELEMENT('EDGE-L1','EdgeGateway-L1','IoT Edge for L1 Rooms',$,$,#185,$,.USERDEFINED.);

/* Put edges into spaces */
#187 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-Edge-Mech',$,'MechRoom-Edge',$,(#183),#90);
#188 = IFCRELCONTAINEDINSPATIALSTRUCTURE('REL-Edge-RM101',$,'Room101-Edge',$,(#186),#70);

/* ======= LINK SENSORS → EDGE DEVICES ======= */
/* Plant sensors managed by EDGE-MECH */
#190 = IFCRELASSIGNSTOACTOR('REL-Plant-Edge',$,'PlantSensors->Edge',$,(#162,#165,#168),#183,$);
/* Room sensors managed by EDGE-L1 */
#191 = IFCRELASSIGNSTOACTOR('REL-Room-Edge',$,'RoomSensors->Edge',$,(#172,#175,#178),#186,$);

/* ======= SYSTEMS (CHILLED WATER & SUPPLY AIR) ======= */
#200 = IFCDISTRIBUTIONSYSTEM('SYS-CHW','ChilledWaterLoop',$,.CHILLEDWATER.);
#201 = IFCDISTRIBUTIONSYSTEM('SYS-SA','SupplyAirSystem',$,.AIRCONDITIONING.);

/* Group equipment into systems */
#205 = IFCRELASSIGNSTOGROUP('REL-CHW-Members',$,'CHW Members',$,(#110,#120,#130),#200);
#206 = IFCRELASSIGNSTOGROUP('REL-SA-Members',$,'Supply Air Members',$,(#130,#142,#145,#152,#155),#201);

/* ======= OPTIONAL: SIMPLE CONNECTIVITY HINTS (not geometric) ======= */
/* AHU “feeds” supply duct segments (semantic hint) */
#210 = IFCRELNESTS('REL-AHU-SA1',$,'AHU feeds DUCT-101',$,#130,(#142));
#211 = IFCRELNESTS('REL-AHU-SA2',$,'AHU feeds DUCT-102',$,#130,(#145));
/* Ducts “lead to” diffusers (semantic hint) */
#212 = IFCRELNESTS('REL-SA1-DF101',$,'DUCT-101 -> DF-101',$,#142,(#152));
#213 = IFCRELNESTS('REL-SA2-DF102',$,'DUCT-102 -> DF-102',$,#145,(#155));

ENDSEC;
END-ISO-10303-21;
