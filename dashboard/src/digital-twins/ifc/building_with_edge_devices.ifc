ISO-10303-21;
HEADER;
FILE_DESCRIPTION(('ViewDefinition [CoordinationView]'),'2;1');
FILE_NAME('building_with_edge_devices.ifc','2025-01-01T00:00:00',('ChatGPT'),('ChatGPT'),'IFC Example','','');
FILE_SCHEMA(('IFC4'));
ENDSEC;

DATA;

/* ORIGIN */
#1 = IFCCARTESIANPOINT((0.,0.,0.));
#2 = IFCAXIS2PLACEMENT3D(#1,$,$);
#3 = IFCGEOMETRICREPRESENTATIONCONTEXT($,'Model',3,1.E-5,#2,$);

/* PROJECT */
#10 = IFCPROJECT('PRJ001','Digital Twin',$,$,$,$,$,(#3));

/* SITE → BUILDING → FLOOR */
#20 = IFCSITE('SITE01','MainSite',$,$,$,$,$,.ELEMENT.,$,$,$,$,.USERDEFINED.);
#30 = IFCBUILDING('BLDG01','MainBuilding',$,$,$,$,$,.ELEMENT.,$,$);
#40 = IFCBUILDINGSTOREY('FLR01','Level 1',$,$,$,$,0.0,.ELEMENT.,$);

/* RELATIONSHIPS: PROJECT → SITE → BUILDING → STOREY */
#100 = IFCRELAGGREGATES('REL01',$,'Project-Site',$,#10,(#20));
#101 = IFCRELAGGREGATES('REL02',$,'Site-Building',$,#20,(#30));
#102 = IFCRELAGGREGATES('REL03',$,'Building-Storey',$,#30,(#40));

/* -------------------
   ROOMS (SPACES)
   ------------------- */

/* Room 101 geometry: (0,0)-(5,0)-(5,4)-(0,4) */
#200 = IFCCARTESIANPOINT((0.,0.,0.));
#201 = IFCCARTESIANPOINT((5.,0.,0.));
#202 = IFCCARTESIANPOINT((5.,4.,0.));
#203 = IFCCARTESIANPOINT((0.,4.,0.));
#204 = IFCPOLYLINE((#200,#201,#202,#203,#200));
#205 = IFCSHAPEREPRESENTATION(#3,'Body','Curve2D',(#204));

#210 = IFCSPACE('RM101','Room 101','Office',$,$,#205,$,.INTERNAL.,.ELEMENT.,$);

/* Room 102 geometry: (6,0)-(11,0)-(11,4)-(6,4) */
#220 = IFCCARTESIANPOINT((6.,0.,0.));
#221 = IFCCARTESIANPOINT((11.,0.,0.));
#222 = IFCCARTESIANPOINT((11.,4.,0.));
#223 = IFCCARTESIANPOINT((6.,4.,0.));
#224 = IFCPOLYLINE((#220,#221,#222,#223,#220));
#225 = IFCSHAPEREPRESENTATION(#3,'Body','Curve2D',(#224));

#230 = IFCSPACE('RM102','Room 102','IT Room',$,$,#225,$,.INTERNAL.,.ELEMENT.,$);

/* Storey → Rooms */
#240 = IFCRELCONTAINEDINSPATIALSTRUCTURE('RELROOM',$,'Storey Spaces',$,(#210,#230),#40);

/* -------------------
   EDGE DEVICES
   ------------------- */

/* Edge Device in Room 101 */
#300 = IFCCARTESIANPOINT((2.5,1.0,1.5));
#301 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#300,$,$));

#310 = IFCDISTRIBUTIONCONTROLELEMENT(
    'EDGE01', 'Edge Device 01', 'IoT Edge Gateway', $, $, #301, $, .USERDEFINED.
);

/* Edge Device in Room 102 */
#320 = IFCCARTESIANPOINT((8.0,1.5,1.5));
#321 = IFCLOCALPLACEMENT($,IFCAXIS2PLACEMENT3D(#320,$,$));

#330 = IFCDISTRIBUTIONCONTROLELEMENT(
    'EDGE02', 'Edge Device 02', 'IoT Edge Gateway', $, $, #321, $, .USERDEFINED.
);

/* Rooms → Edge Devices */
#340 = IFCRELCONTAINEDINSPATIALSTRUCTURE('RELEDGE1',$,'Room 101 Edge',$,(#310),#210);
#341 = IFCRELCONTAINEDINSPATIALSTRUCTURE('RELEDGE2',$,'Room 102 Edge',$,(#330),#230);

/* -------------------
   SENSORS connected to edge devices
   ------------------- */

/* Temp Sensor in Room 101 */
#400 = IFCCARTESIANPOINT((3.0,2.0,1.7));
#401 = IFCLOCALPLACEMENT($, IFCAXIS2PLACEMENT3D(#400,$,$));

#410 = IFCSENSOR(
    'TS101', 'TempSensor-101', 'Temperature Sensor 101',
    $, $, #401, $, 'TEMPERATURESENSOR'
);

/* Humidity Sensor in Room 101 */
#420 = IFCCARTESIANPOINT((1.5,2.0,1.7));
#421 = IFCLOCALPLACEMENT($, IFCAXIS2PLACEMENT3D(#420,$,$));

#430 = IFCSENSOR(
    'HS101', 'HumiditySensor-101', 'Humidity Sensor 101',
    $, $, #421, $, 'HUMIDITYSENSOR'
);

/* CO2 Sensor in Room 102 */
#440 = IFCCARTESIANPOINT((9.0,2.0,1.7));
#441 = IFCLOCALPLACEMENT($, IFCAXIS2PLACEMENT3D(#440,$,$));

#450 = IFCSENSOR(
    'CS102', 'CO2Sensor-102', 'CO2 Sensor 102',
    $, $, #441, $, 'CO2SENSOR'
);

/* -------------------
   SENSOR → EDGE DEVICE RELATIONSHIPS
   ------------------- */

#460 = IFCRELASSIGNSTOACTOR(
    'RELSDG1',$,'Sensors → EdgeDevice 01',$,
    (#410,#430), /* sensors in room 101 */
    #310, $);

#461 = IFCRELASSIGNSTOACTOR(
    'RELSDG2',$,'Sensors → EdgeDevice 02',$,
    (#450), /* sensor in room 102 */
    #330, $);

ENDSEC;
END-ISO-10303-21;
